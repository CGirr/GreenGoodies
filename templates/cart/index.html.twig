{% extends 'base.html.twig' %}

{% block title %}Mon Panier{% endblock %}

{% block body %}
    <section class="cart-section section-beige">
        <h1>Mon panier</h1>

        {% set successMessages = app.flashes('success') %}
        {% set errorMessages = app.flashes('error') %}

        {% for message in successMessages %}
            <div class="cart-success">{{ message }}</div>
        {% endfor %}
        {% for message in errorMessages %}
            <div class="cart-error">{{ message }}</div>
        {% endfor %}

        {% if cart and cart.items is not empty %}
            <div class="cart-empty">
                <a href="{{ path('app_cart_clear') }}">x Vider le panier</a>
            </div>
            <div class="cart-product-list">
                {% for item in cart.items %}
                    <div class="cart-product">
                        {% if item.productImage %}
                            <div class="cart-product-img">
                                <img src="{{ asset('images/' ~ item.productImage) }}" alt="{{ item.productImageAlt }}">
                            </div>
                        {% endif %}
                        <div>
                            <p class="cart-product-name">{{ item.productName }}</p>
                            <p class="cart-product-qty">Quantité : {{ item.quantity }}</p>
                            <p class="cart-product-price">{{ item.unitPrice }}€</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="cart-total">
                <div class="cart-total-content">
                    <p class="cart-total-price">Total panier : <span>{{ cart.totalPrice }}€</span></p>
                    <p class="cart-delivery">Frais de livraison : Offert</p>
                </div>
            </div>
            <div class="cart-validate">
                <a href="{{ path('app_cart_validate') }}" class="btn">Valider la commande</a>
            </div>
        {% elseif successMessages is empty %}
            <p>Votre panier est vide.</p>
        {% endif %}
    </section>
{% endblock %}
